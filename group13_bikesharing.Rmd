# Predicting the Number of Bike Shares
In this analysis we would like to predict the count of bike rentals in Washington DC

## 1. Getting Data
### Data source
We downloaded the dataset "bikesharing.csv" from https://code.datasciencedojo.com/datasciencedojo/datasets/tree/master/Bike%20Sharing.

### Loading the data
In a first step the dataset is imported to R and stored in the data.frame *d.bike*:
```{r}
d.bike <- read.csv("bikesharing.csv", header=TRUE)
```

### Describing the dataset
```{r}
str(d.bike)
```

The dataset contains hourly information about a day and its weather conditions in 17379 observations of 17 variables. In the following, the individual attributes will be explained:

* *instant*: record index
* *dteday*: Date
* *season*: 1 = spring, 2 = summer, 3 = fall, 4 = winter
* *yr*: Year; 0: 2011, 1: 2012
* *mnth*: Month; 1 to 12
* *hr*: Hour; 0 to 23
* *holiday*: 0 = no holiday, 1 = holiday
* *weekday*: Day of the week; 1 to 7
* *workingday*: 0 = weekend or holiday, 1 = working day
* *weathersit*:
  + 1: Clear, Few clouds, Partly cloudy, Partly cloudy
  + 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist
  + 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds
  + 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog 
* *temp*: Normalized temperature in Celsius; The values are derived via (t-t_min)/(t_max-t_min),   t_min=-8, t_max=+39;
* *atemp*:  Normalized feeling temperature in Celsius; Normalized   feeling temperature in Celsius. The values are derived via (t-t_min)/(t_max-t_min), t_min=-16, t_max=+50
* *hum*: Normalized relative humidity; The values are divided to 100 (max); 
* *windspeed*: Normalized windspeed ; The values are divided to 67 (max)
* *casual*: number of non-registered  (eg. tourists)
* *registered*: number of registered users (eg. workers that use bikes daily)
* *cnt*: number of total rentals

### Checking the data
```{r}
head(d.bike)
tail(d.bike)
```

As it looks like the data set was imported completely. To check if there are any missing values (not available, NA) in this dataset we count the number of NAs in the data set.
```{r}
sum(is.na(d.bike))
mean(is.na(d.bike))
```

The record contains no rows with missing data. Now we are ready for the further analysis steps.

## 2. Explorative Data Analysis
Because ggplot allows elegant data visualization with the same syntax for different types of data models, we decide to use ggplot exclusively for graphical representations as far as possible. Therefore we import ggplot2.
```{r}
library(ggplot2)
```

### Count
In the very first step we would like to look at the distribution of the response variable count. For this purpose we create a histogram.
```{r}
ggplot(data = d.bike, aes(x=cnt)) +
  geom_histogram(bins=30, colour="black", ylab="Frequency") + xlab("Count") + ylab("Frequency")
mean(d.bike$cnt)
sd(d.bike$cnt)
```
As we can see, this is a right skewed distribution. So in most hours - the number of bike rentals are hourly observations - between 0 and 30 bikes (the most left bar) are rented.

### Date

```{r}
ggplot(data = d.bike, mapping = aes(y = cnt, x = as.Date(dteday))) +
  geom_point() + scale_x_date(date_breaks = "1 year") + xlab("Date") + ylab("Count")
```

### Season
If we want to visualize the effect of the *season* on the number of bike rentals it is a good idea to use a box plot.
```{r}
ggplot(data = d.bike, aes(group=season, y = cnt, x = as.factor(season))) +
  geom_boxplot() + xlab("Season") + ylab("Count")
```

As the box plot shows, season 1 (spring) is particularly different from season 2, 3 and 4 (summer, autumn and winter). The median is lowest in spring, even lower than in winter. In summer, autumn and winter, the medians differ only marginally.  Since the medians differ partially, one can assume a slight effect. However, we want to examine this more closely.

First we check whether the four seasons differ significantly from season 1. For this we apply a simple linear regression model.
```{r}
lm.season.1 <- lm(cnt ~ as.factor(season), data = d.bike)
summary(lm.season.1)
```

Interpretation:

* *Season 1 (Intercept)*: there is strong evidence that the mean bike rental count is not equal zero.
* *Season 2, 3, 4*: there is strong evidence that the mean bike rental counts from all other *seasons* differ from the reverence level *season 1*.

With an Analysis of Variance (ANOVA) we check whether at least one level of Seasons has a significant effect on the number of bike rentals. The first step is to create a model that does not consider any effect from *season*.

```{r}
lm.season.0 <- lm(cnt ~ 1, data = d.bike)
coef(lm.season.0)
```

With an F-test we now compare both models with each other.

```{r}
anova(lm.season.0, lm.season.1)
```

As we can see from the p-value there is strong evidence that at least one level in *season* has a strong effect on the number of bike rentals. The value of the residual sums of squares also indicates this. In the model with the consideration of *season* the RSS is clearly deeper.

### Year
We also use a box plot to visualize the effect of year.

```{r}
ggplot(data = d.bike, aes(group=yr, y = cnt, x = yr)) +
  geom_boxplot()
```

At first glance we can see that the number of bike rentals has increased in year 1 (2012). The median is above the median of year 0 (2011).

```{r}
lm.year.1 <- lm(cnt ~ as.factor(yr), data = d.bike)
lm.year.0 <- lm(cnt ~ 1, data = d.bike)
anova(lm.season.0, lm.season.1)
```

### Month
```{r}
ggplot(data = d.bike, aes(group=mnth, y = cnt, x = as.factor(mnth))) +
  geom_boxplot() + scale_x_discrete(limits=seq(1,12)) + xlab("Month") + ylab("Count")
```

### Hour
```{r}
ggplot(data = d.bike, aes(group=hr, y = cnt, x = as.factor(hr))) +
  geom_boxplot() + scale_x_discrete(limits=seq(1,23)) + xlab("Hour") + ylab("Count")
```

### Holiday
```{r}
ggplot(data = d.bike, aes(group=holiday, y = cnt, x = holiday)) +
  geom_boxplot() + xlab("Holiday") + ylab("Count")
```



## 3. Modelling the Data
### Model Development

### Linear Regression

### Non-linear Regression

### Poisson Regression

### Logistic Regression

